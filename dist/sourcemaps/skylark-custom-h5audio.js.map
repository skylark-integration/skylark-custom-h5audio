{"version":3,"sources":["skylark-custom-h5audio.js"],"names":["define","langx","styler","noder","eventer","$","plugins","create","el","attr","element","document","createElement","name","undefined","Element","prototype","offset","this","getBoundingClientRect","scrollLeft","window","pageXOffset","documentElement","scrollTop","pageYOffset","top","left","css","getComputedStyle","style","CustomHtml5Audio","Plugin","inherit","klassName","pluginName","options","volume","autoPlay","notification","playList","_construct","elm","call","_index","_repeating","_shuffling","_played","_seeking","_rightClick","_apActive","selectors","_player","className","id","innerHTML","settings","_elm","appendChild","_playBtn","querySelector","_prevBtn","_nextBtn","_repeatBtn","_shuffleBtn","_volumeBtn","_plBtn","_curTime","_durTime","_trackTitle","_progressBar","_progressBarContaner","_preloadBar","_volumeBar","_volumeBarContaner","_playList","listenTo","playToggle","volumeToggle","repeatToggle","shuffleToggle","handlerBar","seek","seekingFalse","handlerVol","setVolume","prev","next","_imageDiv","renderPL","plToggle","_audio","Audio","isEmptyList","empty","src","file","preload","title","height","_volumeLength","error","update","doEnd","classList","add","remove","play","_plLi","html","tpl","forEach","item","i","push","replace","_pl","join","insertBefore","nextSibling","querySelectorAll","listHandler","evt","preventDefault","target","current","parseInt","parentNode","getAttribute","plActive","isDel","splice","removeChild","setAttribute","paused","index","width","_isDel","len","length","icon","image","interactive","_interactive","pause","Array","keys","Math","floor","random","_playBtnclassList","muted","repeat","contains","shuffle","lassList","shuffling","toggle","readyState","barlength","round","currentTime","duration","curMins","curSecs","mins","secs","buffered","loaded","end","moveBar","dir","value","clientX","offsetWidth","offsetHeight","clientY","which","destroy","register","AudioPlayer","main"],"mappings":"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","file":"../skylark-custom-h5audio.js","sourcesContent":["define('skylark-custom-h5audio/player',[\n  \"skylark-langx\",\n  \"skylark-domx-styler\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins-base\"\n],function(langx,styler,noder, eventer,$ , plugins) {\n\n  'use strict'\n\n    var aphtml =\n    '  <div class=\"ap-inner\">'+\n    '    <div class=\"ap-panel\">'+\n    '      <div class=\"ap-item ap--playback\">'+\n    '        <button class=\"ap-controls ap-prev-btn\">'+\n    '          <i class=\"material-icons md-dark\">skip_previous</i>'+\n    '        </button>'+\n    '        <button class=\"ap-controls ap-toggle-btn\">'+\n    '            <i class=\"material-icons md-dark ap--play\">play_arrow</i>'+\n    '            <i class=\"material-icons md-dark ap--pause\">pause</i>'+\n    '        </button>'+\n    '        <button class=\"ap-controls ap-next-btn\">'+\n    '          <i class=\"material-icons md-dark\">skip_next</i>'+\n    '        </button>'+\n    '      </div>'+\n    '      <div class=\"ap-item ap--track\">'+\n    '        <div class=\"ap-info\">'+\n    '          <div class=\"ap-title\">Unknown</div>'+\n    '          <div class=\"ap-time\">'+\n    '            <span class=\"ap-time--current\">--</span>'+\n    '            <span> / </span>'+\n    '            <span class=\"ap-time--duration\">--</span>'+\n    '          </div>'+\n    ''+\n    '          <div class=\"ap-progress-container\">'+\n    '            <div class=\"ap-progress\">'+\n    '              <div class=\"ap-bar\"></div>'+\n    '              <div class=\"ap-preload-bar\"></div>'+\n    '            </div>'+\n    '          </div>'+\n    ''+\n    '        </div>'+\n    '      </div>'+\n    '      <div class=\"ap-item ap--settings\">'+\n    '        <div class=\"ap-controls ap-volume-container\">'+\n    '          <button class=\"ap-controls ap-volume-btn\">'+\n    '              <i class=\"material-icons md-dark ap--volume-on\">volume_up</i>'+\n    '              <i class=\"material-icons md-dark ap--volume-off\">volume_mute</i>'+\n    '          </button>'+\n    '          <div class=\"ap-volume\">'+\n    '            <div class=\"ap-volume-progress\"><div class=\"ap-volume-bar\"></div></div>'+\n    '          </div>'+\n    '        </div>'+\n    '        <button class=\"ap-controls ap-repeat-btn\">'+\n    '          <i class=\"material-icons md-dark\">repeat</i>'+\n    '        </button>'+\n    '        <button class=\"ap-controls ap-shuffle-btn\">'+\n    '          <i class=\"material-icons md-dark\">shuffle</i>'+\n    '        </button>'+\n    '        <button class=\"ap-controls ap-playlist-btn\">'+\n    '          <i class=\"material-icons md-dark\">queue_music</i>'+\n    '        </button>'+\n    '      </div>'+\n    '    </div>'+\n    '  </div>';\n\n\n  function create(el, attr) {\n    var element = document.createElement(el);\n    if(attr) {\n      for(var name in attr) {\n        if(element[name] !== undefined) {\n          element[name] = attr[name];\n        }\n      }\n    }\n    return element;\n  }\n\n  Element.prototype.offset = function() {\n    var el = this.getBoundingClientRect(),\n    scrollLeft = window.pageXOffset || document.documentElement.scrollLeft,\n    scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n    return {\n      top: el.top + scrollTop,\n      left: el.left + scrollLeft\n    };\n  };\n\n  Element.prototype.css = function(attr) {\n    if(typeof attr === 'string') {\n      return getComputedStyle(this, '')[attr];\n    }\n    else if(typeof attr === 'object') {\n      for(var name in attr) {\n        if(this.style[name] !== undefined) {\n          this.style[name] = attr[name];\n        }\n      }\n    }\n  };\n\n\n  var CustomHtml5Audio = plugins.Plugin.inherit({\n    klassName : \"CustomHtml5Audio\",\n\n    pluginName : \"intg.custom_html5_audio\",\n\n    options : {\n      volume   : 0.5,\n      autoPlay : false,\n      notification: false,\n      playList : []\n    },\n\n    _construct: function(elm, options) {\n      //this.options = options\n      plugins.Plugin.prototype._construct.call(this,elm,options);\n\n      this._index = 0;\n      this._repeating = false;\n      this._shuffling = null;\n      this._played = [];\n      this._seeking = false;\n      this._rightClick = false;\n      this._apActive = false;\n\n\n      let $el = this.$(),\n          selectors = this.options.selectors;\n\n      this._player = create('div', {\n        'className': 'ap',\n        'id': 'ap',\n        'innerHTML': aphtml\n      });\n\n      if(this._apActive || this._player === null) {\n        return;\n      }\n\n      let settings = this.options;\n\n      this._elm.appendChild(this._player);\n\n      // get player elements\n      this._playBtn        = this._player.querySelector('.ap-toggle-btn');\n      this._prevBtn        = this._player.querySelector('.ap-prev-btn');\n      this._nextBtn        = this._player.querySelector('.ap-next-btn');\n      this._repeatBtn      = this._player.querySelector('.ap-repeat-btn');\n      this._shuffleBtn     = this._player.querySelector('.ap-shuffle-btn');\n      this._volumeBtn      = this._player.querySelector('.ap-volume-btn');\n      this._plBtn          = this._player.querySelector('.ap-playlist-btn');\n      this._curTime        = this._player.querySelector('.ap-time--current');\n      this._durTime        = this._player.querySelector('.ap-time--duration');\n      this._trackTitle     = this._player.querySelector('.ap-title');\n      this._progressBar    = this._player.querySelector('.ap-bar');\n      this._progressBarContaner    = this._player.querySelector('.ap-progress-container');\n      this._preloadBar     = this._player.querySelector('.ap-preload-bar');\n      this._volumeBar      = this._player.querySelector('.ap-volume-bar');\n      this._volumeBarContaner    = this._player.querySelector('.ap-volume-container');\n\n      this._playList = settings.playList;\n\n\n      this.listenTo($(this._playBtn),'click', this.playToggle);\n      this.listenTo($(this._volumeBtn),'click', this.volumeToggle);\n      this.listenTo($(this._repeatBtn),'click', this.repeatToggle);\n      this.listenTo($(this._shuffleBtn),'click', this.shuffleToggle);\n\n      this.listenTo($(this._progressBarContaner),'mousedown', this.handlerBar);\n      this.listenTo($(this._progressBarContaner),'mousemove', this.seek);\n      this.listenTo($(document),'mouseup', this.seekingFalse);\n\n      this.listenTo($(this._volumeBarContaner),'mousedown', this.handlerVol);\n      this.listenTo($(this._volumeBarContaner),'mousemove', this.setVolume);\n      this.listenTo($(document),'mouseup', this.seekingFalse);\n\n      this.listenTo($(this._prevBtn),'click', this.prev);\n      this.listenTo($(this._nextBtn),'click', this.next);\n\n      this._imageDiv = create('div', {\n        'className': 'ap-image'\n      })\n      this._elm.appendChild(this._imageDiv)\n\n      this._apActive = true;\n\n      // Create playlist\n      this.renderPL();\n      this.listenTo($(this._plBtn),'click', this.plToggle);\n\n      // Create audio object\n      this._audio = new Audio();\n      this._audio.volume = settings.volume;\n\n\n\n      if(this.isEmptyList()) {\n        this.empty();\n        return;\n      }\n\n      this._audio.src = this._playList[this._index].file;\n      this._audio.preload = 'auto';\n      this._trackTitle.innerHTML = this._playList[this._index].title;\n      this._volumeBar.style.height = this._audio.volume * 100 + '%';\n      this._volumeLength = this._volumeBar.css('height');\n\n      this.listenTo($(this._audio),'error', this.error);\n      this.listenTo($(this._audio),'timeupdate', this.update);\n      this.listenTo($(this._audio),'ended', this.doEnd);\n      this.listenTo($(this._audio),'play', () => {\n        this._playBtn.classList.add('playing');\n      }, false)\n      this.listenTo($(this._audio),'pause', () => {\n        this._playBtn.classList.remove('playing');\n      }, false)\n\n      if(settings.autoPlay) {\n        this._audio.play();\n        this._plLi[this._index].classList.add('pl-current');\n      }\n\n\n\n    },\n\n\n    /**\n     *  PlayList methods\n     */\n    renderPL : function () {\n      var html = [];\n      var tpl =\n        '<li data-track=\"{count}\">'+\n          '<div class=\"pl-number\">'+\n            '<div class=\"pl-count\">'+\n              '<i class=\"material-icons\">audiotrack</i>'+\n            '</div>'+\n            '<div class=\"pl-playing\">'+\n              '<div class=\"eq\">'+\n                '<div class=\"eq-bar\"></div>'+\n                '<div class=\"eq-bar\"></div>'+\n                '<div class=\"eq-bar\"></div>'+\n              '</div>'+\n            '</div>'+\n          '</div>'+\n          '<div class=\"pl-title\">{title}</div>'+\n          '<button class=\"pl-remove\">'+\n              '<i class=\"material-icons\">delete</i>'+\n          '</button>'+\n        '</li>';\n\n      this._playList.forEach(function(item, i) {\n        html.push(\n          tpl.replace('{count}', i).replace('{title}', item.title)\n        );\n      });\n\n      this._pl = create('div', {\n        'className': 'pl-container hide',\n        'id': 'pl',\n        'innerHTML': !this.isEmptyList() ? '<ul class=\"pl-list\">' + html.join('') + '</ul>' : '<div class=\"pl-empty\">PlayList is empty</div>'\n      });\n\n      this._elm.insertBefore(this._pl, this._player.nextSibling);\n\n      this._plLi = this._pl.querySelectorAll('li');\n\n      this.listenTo($(this._pl),'click', this.listHandler);\n    },\n\n    listHandler : function (evt) {\n      evt.preventDefault();\n      if(evt.target.className === 'pl-title') {\n        var current = parseInt(evt.target.parentNode.getAttribute('data-track'), 10);\n        this._index = current;\n        this.play();\n        this.plActive();\n      }\n      else {\n        var target = evt.target;\n        while(target.className !== this._pl.className) {\n          if(target.className === 'pl-remove') {\n            var isDel = parseInt(target.parentNode.getAttribute('data-track'), 10);\n\n            this._playList.splice(isDel, 1);\n            target.parentNode.parentNode.removeChild(target.parentNode);\n\n            this._plLi = this._pl.querySelectorAll('li');\n\n            [].forEach.call(this._plLi, function(el, i) {\n              el.setAttribute('data-track', i);\n            });\n\n            if(!this._audio.paused) {\n\n              if(this._isDel === this._index) {\n                this.play();\n              }\n\n            }\n            else {\n              if(this.isEmptyList()) {\n                this.empty();\n              }\n              else {\n                // audio.currentTime = 0;\n                this._audio.src = this._playList[index].file;\n                document.title = this._trackTitle.innerHTML = this._playList[index].title;\n                this._progressBar.style.width = 0;\n              }\n            }\n            if(this._isDel < this._index) {\n              this._index--;\n            }\n\n            return;\n          }\n          target = target.parentNode;\n        }\n\n      }\n    },\n\n    plActive : function () {\n      if(this._audio.paused) {\n        this._plLi[index].classList.remove('pl-current');\n        return;\n      }\n      var current = this._index;\n      for(var i = 0, len = this._plLi.length; len > i; i++) {\n        this._plLi[i].classList.remove('pl-current');\n      }\n      this._plLi[current].classList.add('pl-current');\n\n      this._imageDiv.innerHTML = ''\n      if (this._playList[current].icon) {\n        let image = create('img', {\n          src: this._playList[current].icon\n        })\n        this._imageDiv.appendChild(image)\n      }\n    },\n\n\n  /**\n   *  Player methods\n   */\n    error : function () {\n      if (!this.isEmptyList()){\n        this.next();\n      } \n    },\n\n\n   play : function () {\n\n      this._index = (this._index > this._playList.length - 1) ? 0 : this._index;\n      if(this._index < 0) this._index = this._playList.length - 1;\n\n      if(this.isEmptyList()) {\n        this.empty();\n        return;\n      }\n\n      this._played.push(this._index)\n\n      this._audio.src = this._playList[this._index].file;\n      this._audio.preload = 'auto';\n      document.title = this._trackTitle.innerHTML = this._playList[this._index].title;\n      this._audio.play();\n      ///notify(playList[index].title, {\n      ///  icon: playList[index].icon,\n      ///  body: 'Now playing',\n      ///  tag: 'music-player'\n      ///});\n      this.plActive();\n    },\n\n    prev : function () {\n      if (this._played.length > 1) {\n        this._index = this._played.splice(-2)[0];\n      } else {\n        this._index = 0;\n      }\n\n      this.play();\n    },\n\n    next : function (interactive) {\n      if (this._shuffling) {\n        if (this._shuffling.length === 0) {\n          if (this._repeating || this._interactive) {\n            this._shuffling = [...Array(this._playList.length).keys()]\n          } else {\n            this._audio.pause();\n            this.plActive();\n            \n            return;\n          }\n        }\n\n        let i = Math.floor(Math.random() * this._shuffling.length);\n        this._index = this._shuffling.splice(i, 1)[0];\n      } else {\n        if (this._index === this._playList.length - 1 && (!this._repeating && !this._interactive)) {\n          this._audio.pause();\n          this.plActive();\n          this._playBtn.classList.remove('playing');\n          return;\n        }\n\n        this._index = (this._index === this._playList.length - 1) ? 0 : this._index + 1;\n      }\n\n      this.play();\n    },\n\n    isEmptyList : function () {\n      return this._playList.length === 0;\n    },\n\n    empty : function () {\n      this._audio.pause();\n      this._audio.src = '';\n      this._trackTitle.innerHTML = 'queue is empty';\n      this._curTime.innerHTML = '--';\n      this._durTime.innerHTML = '--';\n      this._progressBar.style.width = 0;\n      this._preloadBar.style.width = 0;\n      this._pl.innerHTML = '<div class=\"pl-empty\">PlayList is empty</div>';\n    },\n\n    playToggle : function () {\n      if(this.isEmptyList()) {\n        return;\n      }\n      if(this._audio.paused) {\n        this._audio.play();\n        //notify(playList[index].title, {\n        //  icon: playList[index].icon,\n        //  body: 'Now playing'\n        //});\n        this._playBtn.classList.add('playing');\n      }\n      else {\n        this._audio.pause();\n        this._playBtnclassList.remove('playing');\n      }\n      this.plActive();\n    },\n\n    volumeToggle : function () {\n      if(this._audio.muted) {\n        if(parseInt(this._volumeLength, 10) === 0) {\n          this._volumeBar.style.height = '100%';\n          this._audio.volume = 1;\n        }\n        else {\n          this._volumeBar.style.height = this._volumeLength;\n        }\n        this._audio.muted = false;\n        this._volumeBtn.classList.remove('muted');\n      }\n      else {\n        this._audio.muted = true;\n        this._volumeBar.style.height = 0;\n        this._volumeBtn.classList.add('muted');\n      }\n    },\n\n    repeatToggle : function () {\n      var repeat = this._repeatBtn.classList;\n      if(repeat.contains('ap-active')) {\n        this._repeating = false;\n        repeat.remove('ap-active');\n      }\n      else {\n        this._repeating = true;\n        repeat.add('ap-active');\n      }\n    },\n\n    shuffleToggle :function () {\n      var shuffle = this._shuffleBtn.lassList;\n      if(shuffle.contains('ap-active')) {\n        shuffling = null;\n        shuffle.remove('ap-active');\n      }\n      else {\n        shuffling = [...Array(this._playList.length).keys()]\n        shuffle.add('ap-active');\n      }\n    },\n\n    plToggle : function () {\n      this._pl.classList.toggle('ap-active');\n      this._pl.classList.toggle('hide');\n    },\n\n    update : function () {\n      if(this._audio.readyState === 0) return;\n\n      var barlength = Math.round(this._audio.currentTime * (100 / this._audio.duration));\n      this._progressBar.style.width = barlength + '%';\n\n      var\n      curMins = Math.floor(this._audio.currentTime / 60),\n      curSecs = Math.floor(this._audio.currentTime - curMins * 60),\n      mins = Math.floor(this._audio.duration / 60),\n      secs = Math.floor(this._audio.duration - mins * 60);\n      (curSecs < 10) && (curSecs = '0' + curSecs);\n      (secs < 10) && (secs = '0' + secs);\n\n      this._curTime.innerHTML = curMins + ':' + curSecs;\n      this._durTime.innerHTML = mins + ':' + secs;\n\n      var buffered = this._audio.buffered;\n      if(buffered.length) {\n        var loaded = Math.round(100 * buffered.end(0) / this._audio.duration);\n        this._preloadBar.style.width = loaded + '%';\n      }\n    },\n\n    doEnd : function () {\n\n      this.next(false);\n\n    },\n\n    moveBar : function (evt, el, dir) {\n      var value;\n      if(dir === 'horizontal') {\n        value = Math.round( ((evt.clientX - el.offset().left) + window.pageXOffset) * 100 / el.parentNode.offsetWidth);\n        el.style.width = value + '%';\n        return value;\n      }\n      else {\n        var offset = (el.offset().top + el.offsetHeight)  - window.pageYOffset;\n        value = Math.round((offset - evt.clientY));\n        if(value > 100) value = 100;\n        if(value < 0) value = 0;\n        this._volumeBar.style.height = value + '%';\n        return value;\n      }\n    },\n\n    handlerBar : function (evt) {\n      this._rightClick = (evt.which === 3) ? true : false;\n      this._seeking = true;\n      this.seek(evt);\n    },\n\n    handlerVol : function (evt) {\n      this._rightClick = (evt.which === 3) ? true : false;\n      this._seeking = true;\n      this.setVolume(evt);\n    },\n\n    seek : function (evt) {\n      if(this._seeking && this._rightClick === false && this._audio.readyState !== 0) {\n        var value = this.moveBar(evt, this._progressBar, 'horizontal');\n        this._audio.currentTime = this._audio.duration * (value / 100);\n      }\n    },\n\n    seekingFalse : function () {\n      this._seeking = false;\n    },\n\n    setVolume : function (evt) {\n      this._volumeLength = this._volumeBar.css('height');\n      if(this._seeking && this._rightClick === false) {\n        var value = this.moveBar(evt, this._volumeBar.parentNode, 'vertical') / 100;\n        if(value <= 0) {\n          this._audio.volume = 0;\n          this._volumeBtn.classList.add('muted');\n        }\n        else {\n          if(this._audio.muted) this._audio.muted = false;\n          this._audio.volume = value;\n          this._volumeBtn.classList.remove('muted');\n        }\n      }\n    },\n\n\n\n    /* Destroy method. Clear All */\n    destroy : function () {\n      if(!this._apActive) return;\n\n\n      noder.remove(this._player);\n      noder.remove(this._pl);\n\n      this._audio.pause();\n      this._apActive = false;\n    }\n\n  });\n\n  plugins.register(CustomHtml5Audio);\n\n\n  return CustomHtml5Audio;\n\n});\n\ndefine('skylark-custom-h5audio/main',[\r\n\t\"./player\"\r\n],function(AudioPlayer){\r\n\treturn AudioPlayer;\r\n});\ndefine('skylark-custom-h5audio', ['skylark-custom-h5audio/main'], function (main) { return main; });\n\n"]}